# æ¶æ„è¯´æ˜

## ğŸ“ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          WebSocket           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¾®ä¿¡ (WeChat)  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  OpenClaw æœåŠ¡å™¨  â”‚
â”‚                 â”‚                              â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   1. æ¶ˆæ¯è½¬å‘ (message)      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ WAuxiliaryâ”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚  â”‚  Channel   â”‚  â”‚
â”‚  â”‚  Plugin   â”‚  â”‚                              â”‚  â”‚  (æœ¬æ’ä»¶)  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   2. AIå›å¤ (send_text/send_image/send_file) â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚         â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚         â–¼        â”‚
                                                 â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                                 â”‚  â”‚  æ ¸å¿ƒ AI   â”‚  â”‚
                                                 â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ æ¶ˆæ¯æµç¨‹

### æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯
1. ç”¨æˆ·åœ¨å¾®ä¿¡å‘é€æ¶ˆæ¯
2. WAuxiliary æ’ä»¶æ‹¦æˆªæ¶ˆæ¯
3. æ’ä»¶æ£€æŸ¥ç™½åå•ï¼Œé€šè¿‡ WebSocket è½¬å‘åˆ°æœåŠ¡å™¨
4. OpenClaw Channel æ¥æ”¶å¹¶è§£ææ¶ˆæ¯
5. è½¬å‘ç»™ OpenClaw AI æ ¸å¿ƒå¤„ç†

### å‘é€ AI å›å¤
1. OpenClaw AI ç”Ÿæˆå›å¤
2. Channel é€šè¿‡ WebSocket å‘é€ `resolve_target` é¢„è§£æç›®æ ‡
3. WAuxiliary è¿”å› `resolve_target_result`ï¼ˆæœ€ç»ˆ wxid / ç¾¤ talkerï¼‰
4. Channel ä½¿ç”¨è§£æåçš„ç›®æ ‡å‘é€ `send_text` / `send_image` / `send_file`
5. WAuxiliary æ’ä»¶æ¥æ”¶æŒ‡ä»¤å¹¶è°ƒç”¨å¾®ä¿¡ API å‘é€æ¶ˆæ¯

## ğŸ”’ å®‰å…¨æœºåˆ¶

| å±‚çº§ | æªæ–½ | ä½ç½® |
|------|------|------|
| **è¿æ¥è®¤è¯** | Bearer Token | æ’ä»¶ + æœåŠ¡å™¨ |
| **å…¥ç«™æ§åˆ¶** | allowFrom / groupAllowFromï¼ˆæœåŠ¡ç«¯ä¸‹å‘ï¼‰ | æ’ä»¶ |
| **å‡ºç«™æ§åˆ¶** | ç§èŠ allowFrom éªŒè¯ | æ’ä»¶ |
| **ç¾¤èŠé—¨ç¦** | groupPolicy/groupAllowChats/groupAllowFrom/requireMentionInGroup | æ’ä»¶ + æœåŠ¡ç«¯ |
| **DM ç­–ç•¥** | pairing / allowlist / open / disabled | æœåŠ¡ç«¯ |
| **é™é»˜é…å¯¹** | æœªæˆæƒåªç™»è®° pairing è¯·æ±‚ï¼Œä¸è‡ªåŠ¨å›æ¶ˆæ¯ | æœåŠ¡ç«¯ |
| **é€Ÿç‡é™åˆ¶** | 30æ¡/åˆ†é’Ÿ | æ’ä»¶ |
| **æ¶ˆæ¯é‡è¯•** | æœ€å¤š3æ¬¡ï¼Œ30ç§’TTL | æ’ä»¶ |
| **æ—¥å¿—è„±æ•** | URL/Token æ©ç  | æ’ä»¶ |

## ğŸ“¦ ç›®å½•ç»“æ„

```
openclaw-channel-wap/
â”œâ”€â”€ README.md                    # æ€»ä½“è¯´æ˜
â”œâ”€â”€ LICENSE                      # MIT è®¸å¯è¯
â”œâ”€â”€ .gitignore                   # Git å¿½ç•¥é…ç½®
â”‚
â”œâ”€â”€ wap_plugin/                  # WAuxiliary æ’ä»¶ï¼ˆAndroidï¼‰
â”‚   â”œâ”€â”€ README.md                # æ’ä»¶å®‰è£…å’Œé…ç½®è¯´æ˜
â”‚   â”œâ”€â”€ main.java                # æ’ä»¶ä¸»ä»£ç 
â”‚   â””â”€â”€ info.prop                # æ’ä»¶å…ƒæ•°æ®
â”‚
â””â”€â”€ openclaw_plugin/             # OpenClaw Channelï¼ˆnpmåŒ…ï¼‰
    â”œâ”€â”€ README.md                # Channel ä½¿ç”¨è¯´æ˜
    â”œâ”€â”€ package.json             # npm åŒ…é…ç½®
    â”œâ”€â”€ openclaw.plugin.json     # OpenClaw æ’ä»¶å…ƒæ•°æ®
    â”œâ”€â”€ index.ts                 # å…¥å£æ–‡ä»¶
    â”œâ”€â”€ src/                     # æºä»£ç 
    â”‚   â”œâ”€â”€ channel.ts           # Channel å®ç°
    â”‚   â”œâ”€â”€ ws-server.ts         # WebSocket æœåŠ¡å™¨
    â”‚   â””â”€â”€ protocol.ts          # é€šä¿¡åè®®å®šä¹‰
    â””â”€â”€ test/                    # æµ‹è¯•å·¥å…·
        â”œâ”€â”€ standalone-server.ts # ç‹¬ç«‹æœåŠ¡å™¨æµ‹è¯•
        â””â”€â”€ mock-client.ts       # æ¨¡æ‹Ÿå®¢æˆ·ç«¯æµ‹è¯•
```

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
- æ’ä»¶ï¼šç›´æ¥ä¿®æ”¹ `main.java` é…ç½®ååŠ è½½åˆ° WAuxiliary
- Channelï¼šä½¿ç”¨ `npm run test:server` å•ç‹¬æµ‹è¯•

### ç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨ **WSS**ï¼ˆåŠ å¯† WebSocketï¼‰è€Œé WS
- é…ç½®å¼º Tokenï¼ˆ32+ å­—ç¬¦éšæœºå­—ç¬¦ä¸²ï¼‰
- ä¸¥æ ¼é…ç½®ç™½åå•ï¼ˆåŒå‘ï¼‰
- ä½¿ç”¨åå‘ä»£ç†ï¼ˆå¦‚ Nginxï¼‰å¤„ç† SSL
- å®šæœŸæ£€æŸ¥æ—¥å¿—ä¸­çš„å®‰å…¨æ‹¦æˆªè®°å½•

## ğŸ“ åè®®ç‰ˆæœ¬

å½“å‰ç‰ˆæœ¬ï¼š**v3.0.0**

åè®®å…¼å®¹æ€§ï¼šæ’ä»¶ç‰ˆæœ¬å’Œ Channel ç‰ˆæœ¬éœ€ä¿æŒä¸€è‡´ã€‚
